{% extends 'base.html' %} {% load crispy_forms_tags %} {% block title%} create
student {% endblock%} {% block content %}

<style>
  .error {
    color: red;
  }
</style>

<div class="container-fluid">
  <div class="row justify-content-center">
    <div class="col-12">
      <div class="card">
        <div class="card-header">
          {% if form.instance.pk %}
          <h1 class="h4">Update Student</h1>
          {% else %}
          <h1 class="h4">Create Student</h1>
          {% endif %}
        </div>
        <div class="card-body">
          <form method="post" id="studentForm" data-departments-url="{% url 'ajax_load_departments' %}" novalidate
            enctype="multipart/form-data">
            {% csrf_token %}
            <div class="form-row">
              <div class="form-group col-md-6">
                {{form.student_id.label_tag}}
                {{form.student_id}}
                {% for error in form.student_id.errors %}
                <p class="error"><small>{{ error }}</small></p>
                {% endfor %}
              </div>
              <div class="form-group col-md-6">
                {{form.names.label_tag}}
                {{form.names}}
                {% for error in form.names.errors %}
                <p><small class="error">{{ error }}</small></p>
                {% endfor %}
              </div>
            </div>
            <div class="form-row">
              <div class="form-group col-md-6">
                {{form.email.label_tag}}
                {{form.email}}
                {% for error in form.email.errors %}
                <p><small class="error">{{ error }}</small></p>
                {% endfor %}
              </div>
              <div class="form-group col-md-6">
                {{form.phone.label_tag}}
                {{form.phone}}
                {% for error in form.phone.errors %}
                <p><small class="error">{{ error }}</small></p>
                {% endfor %}
              </div>
            </div>
            <div class="form-row">
              <div class="form-check col-md-6">
                {{form.gender.label_tag}}
                {{form.gender}}
                {% for error in form.gender.errors %}
                <p><small class="error">{{ error }}</small></p>
                {% endfor %}
              </div>
              <div class="form-group col-md-6">
                {{form.dob.label_tag}}
                {{form.dob}}
                {% for error in form.dob.errors %}
                <p><small class="error">{{ error }}</small></p>
                {% endfor %}
              </div>
            </div>
            <div class="form-row">
              <div class="form-group col-md-6">
                {{form.faculty.label_tag}}
                {{form.faculty}}
                {% for error in form.faculty.errors %}
                <p><small class="error">{{ error }}</small></p>
                {% endfor %}
              </div>
              <div class="form-group col-md-6">
                {{form.department.label_tag}}
                {{form.department}}
                {% for error in form.department.errors %}
                <p><small class="error">{{ error }}</small></p>
                {% endfor %}
              </div>
            </div>
            <div class="form-row">
              <div class="form-group col-md-4">
                {{form.address.label_tag}}
                {{form.address}}
                {% for error in form.address.errors %}
                <p><small class="error">{{ error }}</small></p>
                {% endfor %}
              </div>
              <div class="form-group col-md-4">
                {{form.status.label_tag}}
                {{form.status}}
                {% for error in form.status.errors %}
                <p><small class="error">{{ error }}</small></p>
                {% endfor %}
              </div>
              <div class="form-group col-md-4">
                {{form.student_status.label_tag}}
                {{form.student_status}}
                {% for error in form.student_status.errors %}
                <p><small class="error">{{ error }}</small></p>
                {% endfor %}
              </div>
              <div class="form-group">
                <label for="note-image">Images</label>
                <input type="file" name="images" class="form-control-file" id="note-image" multiple />
              </div>
            </div>
            <button type="submit" class="btn btn-primary">Submit</button>
          </form>
        </div>
      </div>
    </div>
  </div>
</div>
<script>
  $("#id_faculty").change(function () {
    var url = $("#studentForm").attr("data-departments-url");
    var facultyId = $(this).val();

    $.ajax({
      url: url,
      data: {
        faculty: facultyId,
      },
      success: function (data) {
        $("#id_department").html(data);
      },
    });
  });
</script>

{% endblock %}